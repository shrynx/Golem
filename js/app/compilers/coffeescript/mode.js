define(function(require,exports,module){var e,t,n,i,r,o,s,a,l,c,u,h=module.uri||"",d=(h.substring(0,h.lastIndexOf("/")+1),{}.hasOwnProperty),p=function(e,t){function n(){this.constructor=e}for(var i in t)d.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};o=require("ace/tokenizer").Tokenizer,i=require("ace/mode/coffee_highlight_rules").CoffeeHighlightRules,t=require("ace/mode/matching_brace_outdent").MatchingBraceOutdent,e=require("ace/mode/folding/coffee").FoldMode,n=require("ace/range").Range,r=require("ace/mode/text").Mode,s=require("ace/worker/worker_client").WorkerClient,u=/(?:[({[=:]|[-=]>|\b(?:else|switch|try|catch(?:\s*[$A-Za-z_\x7f-\uffff][$\w\x7f-\uffff]*)?|finally))\s*$/,a=/^(\s*)# ?/,l=/^\s*###(?!#)/,c=/^\s*/,exports.Mode=function(r){function h(){this.$tokenizer=new o((new i).getRules()),this.$outdent=new t,this.foldingRules=new e}return p(h,r),h.prototype.getNextLineIndent=function(e,t,n){var i,r;return i=this.$getIndent(t),r=this.$tokenizer.getLineTokens(t,e).tokens,r.length&&"comment"===r[r.length-1].type||"start"!==e||!u.test(t)||(i+=n),i},h.prototype.toggleCommentLines=function(e,t,i,r){var o,s,u,h;for(console.log("toggle"),u=new n(0,0,0,0),o=h=i;r>=i?r>=h:h>=r;o=r>=i?++h:--h)s=t.getLine(o),l.test(s)||(s=a.test(s)?s.replace(a,"$1"):s.replace(c,"$&# "),u.end.row=u.start.row=o,u.end.column=s.length+2,t.replace(u,s))},h.prototype.checkOutdent=function(e,t,n){return this.$outdent.checkOutdent(t,n)},h.prototype.autoOutdent=function(e,t,n){return this.$outdent.autoOutdent(t,n)},h.prototype.createWorker=function(e){var t;return t=new s(["ace","compilers"],"compilers/coffeescript/worker","Worker"),e&&(t.attachToDocument(e.getDocument()),t.on("error",function(t){return e.setAnnotations([t.data])}),t.on("ok",function(){return function(){return e.clearAnnotations()}}(this))),t},h}(r)});